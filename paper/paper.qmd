---
title: "Forecasting the 2024 US Presidential Election: A Poll-Based Approach"
subtitle: "My subtitle if needed"
author: 
  - Xinxiang Gao
  - Ariel Xing
  - John Zhang
thanks: "Code and data are available at: [https://github.com/xgao28/election_forecast](https://github.com/xgao28/election_forecast)."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(skimr)
library(knitr)
library(GGally)
library(dplyr)
```


# Introduction

Overview paragraph

Estimand paragraph

Results paragraph

Why it matters paragraph

Telegraphing paragraph: The remainder of this paper is structured as follows. 

```{r}
data <- read.csv("../data/01-raw_data/president_polls.csv")
skim(data)

```

```{r}
colnames(data)
```

pollster

pollscore, numeric_grade

sponsor_candidate, sponsor_candidate_party

sample_size

```{r mutate days_towards_election}
data_a <- data %>% 
  select(end_date) %>% 
  mutate(end_date = as.Date(end_date, format="%m/%d/%y"))

# Define the election date
election_date <- as.Date("11/5/24", format="%m/%d/%y")

# Calculate the days towards the election date
data_a <- data_a %>% 
  mutate(days_towards_election = as.numeric(difftime(election_date, end_date, units = "days")))

data$days_towards_election = data_a$days_towards_election
```

```{r pairplot}
#| warning: false
#| message: false

numeric_data <- data %>% 
  select(where(is.numeric)) %>% 
  select(numeric_grade, pollscore, transparency_score, sample_size, pct) %>% 
  filter(complete.cases(.))


# Create a pair plot
ggpairs(numeric_data)
```


```{r}
data %>% 
  select(numeric_grade, pollscore) %>% 
  filter(complete.cases(.)) %>% 
  cor()
```

```{r}
sort(unique(data$sample_size)) %>% 
  summary()
```

```{r}
data %>% 
  filter(numeric_grade >= 2.0) %>% 
  skim()
```




## Overview

We use the statistical programming language R [@citeR].... Our data [@shelter].... Following @tellingstories, we consider...

Overview text

## Measurement
	
Some paragraphs about how we go from a phenomena in the world to an entry in the dataset.

## Outcome variables

Add graphs, tables and text. Use sub-sub-headings for each outcome variable or update the subheading to be singular.



Some of our data is of penguins (@fig-bills), from @palmerpenguins.

```{r}
#| echo: false
#| message: false
#| warning: false
```

Talk more about it.

And also planes (@fig-planes). (You can change the height and width, but don't worry about doing that until you have finished every other aspect of the paper - Quarto will try to make it look nice and the defaults usually work well once you have enough text.)

```{r}

```

Talk way more about it. 

## Predictor variables

Add graphs, tables and text.

Use sub-sub-headings for each outcome variable and feel free to combine a few into one if they go together naturally.








# Model

The goal of our modelling strategy is twofold. Firstly,...

Here we briefly describe the Bayesian analysis model used to investigate... Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up

Define $y_i$ as the number of seconds that the plane remained aloft. Then $\beta_i$ is the wing width and $\gamma_i$ is the wing length, both measured in millimeters.  

\begin{align} 
y_i|\mu_i, \sigma &\sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &= \alpha + \beta_i + \gamma_i\\
\alpha &\sim \mbox{Normal}(0, 2.5) \\
\beta &\sim \mbox{Normal}(0, 2.5) \\
\gamma &\sim \mbox{Normal}(0, 2.5) \\
\sigma &\sim \mbox{Exponential}(1)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`.


### Model justification

We expect a positive relationship between the size of the wings and time spent aloft. In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

Our results are summarized in @tbl-modelresults.

```{r}
#| echo: false
#| message: false
#| warning: false
```

```{r}
#| echo: false
#| message: false
#| warning: false
```




# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

Please don't use these as sub-heading labels - change them to be what your point actually is.

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows...

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows... 

```{r}
#| echo: false
#| message: false
#| warning: false
```

## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...

```{r}
#| echo: false
#| message: false
#| warning: false
```



\newpage


# References


